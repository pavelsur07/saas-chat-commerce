Failed asserting that the Response is successful.
HTTP/1.1 500 Internal Server Error
Cache-Control:          max-age=0, must-revalidate, private
Content-Type:           application/json
Date:                   Sat, 23 Aug 2025 10:29:30 GMT
Expires:                Sat, 23 Aug 2025 10:29:30 GMT
Vary:                   Accept
X-Debug-Exception:      App%5CAI%5CSuggestionService%3A%3A__construct%28%29%3A%20Argument%20%231%20%28%24llm%29%20must%20be%20of%20type%20App%5CService%5CAI%5CLlmClient%2C%20App%5CTests%5CDoubles%5CLlmClientStub%20given%2C%20called%20in%20%2Fapp%2Fvar%2Fcache%2Ftest%2FContainerXxQAETW%2FgetSuggestionServiceService.php%20on%20line%2025
X-Debug-Exception-File: %2Fapp%2Fsrc%2FAI%2FSuggestionService.php:13
X-Robots-Tag:           noindex

{"type":"https:\/\/tools.ietf.org\/html\/rfc2616#section-10","title":"An error occurred","status":500,"detail":"App\\AI\\SuggestionService::__construct(): Argument #1 ($llm) must be of type App\\Service\\AI\\LlmClient, App\\Tests\\Doubles\\LlmClientStub given, called in \/app\/var\/cache\/test\/ContainerXxQAETW\/getSuggestionServiceService.php on line 25","class":"TypeError","trace":[{"namespace":"","short_class":"","class":"","type":"","function":"","file":"\/app\/src\/AI\/SuggestionService.php","line":13,"args":[]},{"namespace":"App\\AI","short_class":"SuggestionService","class":"App\\AI\\SuggestionService","type":"->","function":"__construct","file":"\/app\/var\/cache\/test\/ContainerXxQAETW\/getSuggestionServiceService.php","line":25,"args":[["object","App\\Tests\\Doubles\\LlmClientStub"],["object","App\\AI\\ConversationContextProvider"],["object","App\\AI\\SuggestionPromptBuilder"],["object","App\\Repository\\Messaging\\ClientRepository"],["string","gpt-4o-mini"],["float",0.7],["integer",12],["integer",4000],["integer",10]]},{"namespace":"ContainerXxQAETW","short_class":"getSuggestionServiceService","class":"ContainerXxQAETW\\getSuggestionServiceService","type":"::","function":"do","file":"\/app\/var\/cache\/test\/ContainerXxQAETW\/App_KernelTestDebugContainer.php","line":560,"args":[["object","ContainerXxQAETW\\App_KernelTestDebugContainer"],["boolean",true]]},{"namespace":"ContainerXxQAETW","short_class":"App_KernelTestDebugContainer","class":"ContainerXxQAETW\\App_KernelTestDebugContainer","type":"->","function":"load","file":"\/app\/var\/cache\/test\/ContainerXxQAETW\/getSuggestionControllerService.php","line":24,"args":[["string","getSuggestionServiceService.php"]]},{"namespace":"ContainerXxQAETW","short_class":"getSuggestionControllerService","class":"ContainerXxQAETW\\getSuggestionControllerService","type":"::","function":"do","file":"\/app\/var\/cache\/test\/ContainerXxQAETW\/App_KernelTestDebugContainer.php","line":560,"args":[["object","ContainerXxQAETW\\App_KernelTestDebugContainer"],["boolean",true]]},{"namespace":"ContainerXxQAETW","short_class":"App_KernelTestDebugContainer","class":"ContainerXxQAETW\\App_KernelTestDebugContainer","type":"->","function":"load","file":"\/app\/vendor\/symfony\/dependency-injection\/Container.php","line":221,"args":[["string","getSuggestionControllerService.php"]]},{"namespace":"Symfony\\Component\\DependencyInjection","short_class":"Container","class":"Symfony\\Component\\DependencyInjection\\Container","type":"::","function":"make","file":"\/app\/vendor\/symfony\/dependency-injection\/Container.php","line":203,"args":[["object","ContainerXxQAETW\\App_KernelTestDebugContainer"],["string","App\\Controller\\Api\\SuggestionController"],["integer",1]]},{"namespace":"Symfony\\Component\\DependencyInjection","short_class":"Container","class":"Symfony\\Component\\DependencyInjection\\Container","type":"->","function":"get","file":"\/app\/vendor\/symfony\/http-kernel\/Controller\/ContainerControllerResolver.php","line":38,"args":[["string","App\\Controller\\Api\\SuggestionController"]]},{"namespace":"Symfony\\Component\\HttpKernel\\Controller","short_class":"ContainerControllerResolver","class":"Symfony\\Component\\HttpKernel\\Controller\\ContainerControllerResolver","type":"->","function":"instantiateController","file":"\/app\/vendor\/symfony\/framework-bundle\/Controller\/ControllerResolver.php","line":25,"args":[["string","App\\Controller\\Api\\SuggestionController"]]},{"namespace":"Symfony\\Bundle\\FrameworkBundle\\Controller","short_class":"ControllerResolver","class":"Symfony\\Bundle\\FrameworkBundle\\Controller\\ControllerResolver","type":"->","function":"instantiateController","file":"\/app\/vendor\/symfony\/http-kernel\/Controller\/ControllerResolver.php","line":127,"args":[["string","App\\Controller\\Api\\SuggestionController"]]},{"namespace":"Symfony\\Component\\HttpKernel\\Controller","short_class":"ControllerResolver","class":"Symfony\\Component\\HttpKernel\\Controller\\ControllerResolver","type":"->","function":"createController","file":"\/app\/vendor\/symfony\/http-kernel\/Controller\/ControllerResolver.php","line":95,"args":[["string","App\\Controller\\Api\\SuggestionController::generate"]]},{"namespace":"Symfony\\Component\\HttpKernel\\Controller","short_class":"ControllerResolver","class":"Symfony\\Component\\HttpKernel\\Controller\\ControllerResolver","type":"->","function":"getController","file":"\/app\/vendor\/symfony\/http-kernel\/Controller\/TraceableControllerResolver.php","line":33,"args":[["object","Symfony\\Component\\HttpFoundation\\Request"]]},{"namespace":"Symfony\\Component\\HttpKernel\\Controller","short_class":"TraceableControllerResolver","class":"Symfony\\Component\\HttpKernel\\Controller\\TraceableControllerResolver","type":"->","function":"getController","file":"\/app\/vendor\/symfony\/http-kernel\/HttpKernel.php","line":166,"args":[["object","Symfony\\Component\\HttpFoundation\\Request"]]},{"namespace":"Symfony\\Component\\HttpKernel","short_class":"HttpKernel","class":"Symfony\\Component\\HttpKernel\\HttpKernel","type":"->","function":"handleRaw","file":"\/app\/vendor\/symfony\/http-kernel\/HttpKernel.php","line":76,"args":[["object","Symfony\\Component\\HttpFoundation\\Request"],["integer",1]]},{"namespace":"Symfony\\Component\\HttpKernel","short_class":"HttpKernel","class":"Symfony\\Component\\HttpKernel\\HttpKernel","type":"->","function":"handle","file":"\/app\/vendor\/symfony\/http-kernel\/Kernel.php","line":182,"args":[["object","Symfony\\Component\\HttpFoundation\\Request"],["integer",1],["boolean",true]]},{"namespace":"Symfony\\Component\\HttpKernel","short_class":"Kernel","class":"Symfony\\Component\\HttpKernel\\Kernel","type":"->","function":"handle","file":"\/app\/vendor\/symfony\/http-kernel\/HttpKernelBrowser.php","line":62,"args":[["object","Symfony\\Component\\HttpFoundation\\Request"],["integer",1],["boolean",true]]},{"namespace":"Symfony\\Component\\HttpKernel","short_class":"HttpKernelBrowser","class":"Symfony\\Component\\HttpKernel\\HttpKernelBrowser","type":"->","function":"doRequest","file":"\/app\/vendor\/symfony\/framework-bundle\/KernelBrowser.php","line":157,"args":[["object","Symfony\\Component\\HttpFoundation\\Request"]]},{"namespace":"Symfony\\Bundle\\FrameworkBundle","short_class":"KernelBrowser","class":"Symfony\\Bundle\\FrameworkBundle\\KernelBrowser","type":"->","function":"doRequest","file":"\/app\/vendor\/symfony\/browser-kit\/AbstractBrowser.php","line":378,"args":[["object","Symfony\\Component\\HttpFoundation\\Request"]]},{"namespace":"Symfony\\Component\\BrowserKit","short_class":"AbstractBrowser","class":"Symfony\\Component\\BrowserKit\\AbstractBrowser","type":"->","function":"request","file":"\/app\/tests\/Integration\/AI\/SuggestionsControllerTest.php","line":72,"args":[["string","POST"],["string","http:\/\/localhost\/api\/suggestions\/1ca06bab-b200-4068-89df-0ffd897c8a1d"],["array",[]],["array",[]],["array",{"HTTP_USER_AGENT":["string","Symfony BrowserKit"],"CONTENT_TYPE":["string","application\/json"],"HTTP_ACCEPT":["string","application\/json"],"HTTP_HOST":["string","localhost"],"HTTPS":["boolean",false]}],["string","{\"lastMessage\":\"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435\",\"historyLimit\":2}"]]},{"namespace":"App\\Tests\\Integration\\AI","short_class":"SuggestionsControllerTest","class":"App\\Tests\\Integration\\AI\\SuggestionsControllerTest","type":"->","function":"testHappyPath","file":"\/app\/vendor\/phpunit\/phpunit\/src\/Framework\/TestCase.php","line":1656,"args":[]},{"namespace":"PHPUnit\\Framework","short_class":"TestCase","class":"PHPUnit\\Framework\\TestCase","type":"->","function":"runTest","file":"\/app\/vendor\/phpunit\/phpunit\/src\/Framework\/TestCase.php","line":514,"args":[]},{"namespace":"PHPUnit\\Framework","short_class":"TestCase","class":"PHPUnit\\Framework\\TestCase","type":"->","function":"runBare","file":"\/app\/vendor\/phpunit\/phpunit\/src\/Framework\/TestRunner\/TestRunner.php","line":87,"args":[]},{"namespace":"PHPUnit\\Framework","short_class":"TestRunner","class":"PHPUnit\\Framework\\TestRunner","type":"->","function":"run","file":"\/app\/vendor\/phpunit\/phpunit\/src\/Framework\/TestCase.php","line":361,"args":[["object","App\\Tests\\Integration\\AI\\SuggestionsControllerTest"]]},{"namespace":"PHPUnit\\Framework","short_class":"TestCase","class":"PHPUnit\\Framework\\TestCase","type":"->","function":"run","file":"\/app\/vendor\/phpunit\/phpunit\/src\/Framework\/TestSuite.php","line":369,"args":[]},{"namespace":"PHPUnit\\Framework","short_class":"TestSuite","class":"PHPUnit\\Framework\\TestSuite","type":"->","function":"run","file":"\/app\/vendor\/phpunit\/phpunit\/src\/Framework\/TestSuite.php","line":369,"args":[]},{"namespace":"PHPUnit\\Framework","short_class":"TestSuite","class":"PHPUnit\\Framework\\TestSuite","type":"->","function":"run","file":"\/app\/vendor\/phpunit\/phpunit\/src\/Framework\/TestSuite.php","line":369,"args":[]},{"namespace":"PHPUnit\\Framework","short_class":"TestSuite","class":"PHPUnit\\Framework\\TestSuite","type":"->","function":"run","file":"\/app\/vendor\/phpunit\/phpunit\/src\/TextUI\/TestRunner.php","line":64,"args":[]},{"namespace":"PHPUnit\\TextUI","short_class":"TestRunner","class":"PHPUnit\\TextUI\\TestRunner","type":"->","function":"run","file":"\/app\/vendor\/phpunit\/phpunit\/src\/TextUI\/Application.php","line":210,"args":[["object","PHPUnit\\TextUI\\Configuration\\Configuration"],["object","PHPUnit\\Runner\\ResultCache\\DefaultResultCache"],["object","PHPUnit\\Framework\\TestSuite"]]},{"namespace":"PHPUnit\\TextUI","short_class":"Application","class":"PHPUnit\\TextUI\\Application","type":"->","function":"run","file":"\/app\/vendor\/phpunit\/phpunit\/phpunit","line":104,"args":[["array",[["string",".\/vendor\/bin\/phpunit"],["string","--testsuite=integration"]]]]},{"namespace":"","short_class":"","class":"","type":"","function":"include","file":"\/app\/vendor\/bin\/phpunit","line":122,"args":[["string","\/app\/vendor\/phpunit\/phpunit\/phpunit"]]}]}

/app/vendor/symfony/framework-bundle/Test/BrowserKitAssertionsTrait.php:148
/app/vendor/symfony/framework-bundle/Test/BrowserKitAssertionsTrait.php:33
/app/tests/Integration/AI/SuggestionsControllerTest.php:80

Caused by
ErrorException: App\AI\SuggestionService::__construct(): Argument #1 ($llm) must be of type App\Service\AI\LlmClient, App\Tests\Doubles\LlmClientStub given, called in /app/var/cache/test/ContainerXxQAETW/getSuggestionServiceService.php on line 25

/app/src/AI/SuggestionService.php:13
/app/vendor/symfony/framework-bundle/Test/BrowserKitAssertionsTrait.php:33
/app/tests/Integration/AI/SuggestionsControllerTest.php:80
